<!DOCTYPE html>
<html>
<head>
    <title>The Next Event API Tester</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .endpoint { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .endpoint h3 { margin-top: 0; color: #333; }
        .response { background: #f5f5f5; padding: 10px; margin-top: 10px; border-radius: 3px; font-family: monospace; white-space: pre-wrap; }
        .error { color: red; }
        .success { color: green; }
        button { background: #007bff; color: white; border: none; padding: 8px 15px; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .status { font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>The Next Event API Tester</h1>
        <p>اختبار سريع للـ API endpoints بعد النشر على Monster ASP</p>
        
        <div class="endpoint">
            <h3>1. Root Endpoint</h3>
            <button onclick="testEndpoint('/', 'root')">Test /</button>
            <div id="root-response" class="response"></div>
        </div>
        
        <div class="endpoint">
            <h3>2. Health Check</h3>
            <button onclick="testEndpoint('/health', 'health')">Test /health</button>
            <div id="health-response" class="response"></div>
        </div>
        
        <div class="endpoint">
            <h3>3. Content API (Public)</h3>
            <button onclick="testEndpoint('/api/content', 'content')">Test /api/content</button>
            <div id="content-response" class="response"></div>
        </div>
        
        <div class="endpoint">
            <h3>4. Swagger JSON</h3>
            <button onclick="testEndpoint('/swagger/v1/swagger.json', 'swagger')">Test Swagger JSON</button>
            <div id="swagger-response" class="response"></div>
        </div>
        
        <div class="endpoint">
            <h3>5. Forms Submit (Public)</h3>
            <button onclick="testFormSubmit()">Test Form Submit</button>
            <div id="form-response" class="response"></div>
        </div>
    </div>

    <script>
        const baseUrl = 'https://thenextevent.runasp.net';
        
        async function testEndpoint(endpoint, id) {
            const responseDiv = document.getElementById(id + '-response');
            responseDiv.innerHTML = 'Testing...';
            
            try {
                const response = await fetch(baseUrl + endpoint, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                    }
                });
                
                const data = await response.json();
                const status = response.ok ? 'SUCCESS' : 'ERROR';
                const statusClass = response.ok ? 'success' : 'error';
                
                responseDiv.innerHTML = `<div class="status ${statusClass}">Status: ${status} (${response.status})</div>` + 
                                      JSON.stringify(data, null, 2);
            } catch (error) {
                responseDiv.innerHTML = `<div class="status error">ERROR: ${error.message}</div>`;
            }
        }
        
        async function testFormSubmit() {
            const responseDiv = document.getElementById('form-response');
            responseDiv.innerHTML = 'Testing form submission...';
            
            const testData = {
                formType: 'contact',
                submitterName: 'Test User',
                submitterEmail: 'test@example.com',
                submitterPhone: '+1234567890',
                message: 'This is a test message from API tester',
                additionalData: {
                    source: 'api-tester'
                }
            };
            
            try {
                const response = await fetch(baseUrl + '/api/forms/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                const status = response.ok ? 'SUCCESS' : 'ERROR';
                const statusClass = response.ok ? 'success' : 'error';
                
                responseDiv.innerHTML = `<div class="status ${statusClass}">Status: ${status} (${response.status})</div>` + 
                                      JSON.stringify(data, null, 2);
            } catch (error) {
                responseDiv.innerHTML = `<div class="status error">ERROR: ${error.message}</div>`;
            }
        }
        
        // Auto-test root endpoint on page load
        window.onload = function() {
            testEndpoint('/', 'root');
        };
    </script>
</body>
</html>
